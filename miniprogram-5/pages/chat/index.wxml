<t-navbar title="è¯¦æƒ…" left-arrow />

<view class="detail-container" wx:if="{{post}}">
  <!-- å›¾ç‰‡è½®æ’­ -->
  <swiper class="image-swiper" indicator-dots autoplay circular>
    <swiper-item wx:for="{{post.images}}" wx:key="id">
      <image
        src="{{item.url}}"
        mode="aspectFill"
        data-url="{{item.url}}"
        bindtap="previewImage"
      />
    </swiper-item>
  </swiper>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="info-card">
    <view class="type-badge {{post.type === 'LOST' ? 'lost' : 'found'}}">
      {{post.type === 'LOST' ? 'å¤±ç‰©' : 'æ‹›é¢†'}}
    </view>
    <view class="desc">{{post.description}}</view>
    <view class="meta">
      <text class="category">{{post.category.name}}</text>
      <text class="location" wx:if="{{post.locationText}}">ğŸ“{{post.locationText}}</text>
    </view>
    <view class="tags" wx:if="{{post.tags && post.tags.length}}">
      <text wx:for="{{post.tags}}" wx:key="*this" class="tag">{{item}}</text>
    </view>
    <view class="contact" wx:if="{{post.contactPhone}}">
      <text>è”ç³»ç”µè¯ï¼š{{post.contactPhone}}</text>
      <t-button size="extra-small" theme="primary" bindtap="makeCall">æ‹¨æ‰“</t-button>
    </view>
  </view>

  <!-- ç•™è¨€åŒº -->
  <view class="comment-section">
    <view class="section-title">ç•™è¨€ ({{comments.length}})</view>

    <view class="comment-input">
      <input
        placeholder="å†™ä¸‹ä½ çš„ç•™è¨€..."
        value="{{commentInput}}"
        bindinput="onCommentInput"
      />
      <t-button size="small" theme="primary" bindtap="submitComment">å‘é€</t-button>
    </view>

    <view class="comment-list">
      <view wx:if="{{comments.length === 0}}" class="empty-comment">æš‚æ— ç•™è¨€</view>
      <view wx:for="{{comments}}" wx:key="id" class="comment-item">
        <t-avatar image="{{item.user.avatarUrl}}" size="small" />
        <view class="comment-content">
          <view class="comment-user">{{item.user.nickname}}</view>
          <view class="comment-text">{{item.content}}</view>
        </view>
      </view>
    </view>
  </view>
</view>

<view wx:if="{{loading}}" class="loading-container">
  <t-loading theme="circular" size="80rpx" />
</view>
